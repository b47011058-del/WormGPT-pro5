<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WormGPT Chat - Pro</title>
  <style>
    /* Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø© */
    :root {
      --primary-color: #00ff88;
      --primary-dark: #00cc6a;
      --bg-color: #0a0a0f;
      --bg-light: #111117;
      --bg-input: #1a1a23;
      --text-color: #f0f0f0;
      --user-color: #4dabf7;
      --border-radius: 12px;
      --transition: all 0.3s ease;
      --premium-color: #ffd700;
      --premium-dark: #ffaa00;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg-color);
      color: var(--text-color);
      line-height: 1.6;
      padding: 20px;
      min-height: 100vh;
      background-image: 
        radial-gradient(circle at 10% 20%, rgba(0, 255, 136, 0.05) 0%, transparent 20%),
        radial-gradient(circle at 90% 80%, rgba(0, 255, 136, 0.05) 0%, transparent 20%);
    }
    
    .container {
      max-width: 800px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      height: calc(100vh - 40px);
      gap: 20px;
    }
    
    /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
    header {
      text-align: center;
      padding: 20px 0;
      border-bottom: 1px solid rgba(0, 255, 136, 0.2);
      position: relative;
    }
    
    .logo {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      margin-bottom: 10px;
    }
    
    h1 {
      color: var(--primary-color);
      font-size: 2.2rem;
      letter-spacing: 1px;
      text-shadow: 0 0 10px rgba(0, 255, 136, 0.3);
    }
    
    .logo-icon {
      font-size: 2.5rem;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    
    .tagline {
      color: #aaa;
      font-size: 1rem;
      margin-top: 5px;
    }
    
    /* Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ±Ø®ÙŠØµ */
    .license-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      backdrop-filter: blur(5px);
    }
    
    .license-box {
      background: var(--bg-light);
      padding: 30px;
      border-radius: var(--border-radius);
      width: 90%;
      max-width: 500px;
      border: 2px solid var(--primary-color);
      box-shadow: 0 0 30px rgba(0, 255, 136, 0.3);
      text-align: center;
    }
    
    .license-box h2 {
      color: var(--primary-color);
      margin-bottom: 20px;
      font-size: 1.8rem;
    }
    
    .license-box p {
      margin-bottom: 20px;
      line-height: 1.6;
    }
    
    .license-input {
      width: 100%;
      padding: 15px;
      margin: 15px 0;
      background: var(--bg-input);
      border: 2px solid var(--primary-color);
      border-radius: var(--border-radius);
      color: var(--text-color);
      font-size: 1.1rem;
      text-align: center;
      letter-spacing: 2px;
    }
    
    .license-input:focus {
      outline: none;
      box-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
    }
    
    .license-btn {
      background: var(--primary-color);
      color: #000;
      border: none;
      padding: 15px 30px;
      border-radius: var(--border-radius);
      font-size: 1.1rem;
      font-weight: bold;
      cursor: pointer;
      transition: var(--transition);
      width: 100%;
      margin-top: 10px;
    }
    
    .license-btn:hover {
      background: var(--primary-dark);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 255, 136, 0.3);
    }
    
    .license-status {
      margin-top: 15px;
      padding: 10px;
      border-radius: var(--border-radius);
      display: none;
    }
    
    .status-success {
      background: rgba(0, 255, 136, 0.1);
      border: 1px solid var(--primary-color);
      color: var(--primary-color);
    }
    
    .status-error {
      background: rgba(255, 0, 0, 0.1);
      border: 1px solid #ff4444;
      color: #ff4444;
    }
    
    .premium-badge {
      background: linear-gradient(45deg, #ffd700, #ffaa00);
      color: #000;
      padding: 5px 15px;
      border-radius: 20px;
      font-weight: bold;
      font-size: 0.9rem;
      display: inline-flex;
      align-items: center;
      gap: 5px;
      margin-left: 10px;
      animation: shine 2s infinite;
    }
    
    @keyframes shine {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.8; }
    }
    
    /* Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ­ÙƒÙ… */
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      padding: 20px;
      background: var(--bg-light);
      border-radius: var(--border-radius);
      border: 1px solid rgba(0, 255, 136, 0.1);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }
    
    .control-group {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 15px;
      background: var(--bg-input);
      border-radius: var(--border-radius);
      border: 1px solid rgba(0, 255, 136, 0.2);
      transition: var(--transition);
    }
    
    .control-group:hover {
      border-color: var(--primary-color);
      box-shadow: 0 0 8px rgba(0, 255, 136, 0.2);
    }
    
    .control-group label {
      cursor: pointer;
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    input[type="checkbox"] {
      width: 18px;
      height: 18px;
      accent-color: var(--primary-color);
      cursor: pointer;
    }
    
    input[type="file"] {
      display: none;
    }
    
    .file-label {
      background: var(--primary-color);
      color: #000;
      padding: 8px 15px;
      border-radius: var(--border-radius);
      font-weight: bold;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .file-label:hover {
      background: var(--primary-dark);
      transform: translateY(-2px);
    }
    
    .file-info {
      font-size: 0.85rem;
      color: #aaa;
      margin-right: 10px;
      max-width: 200px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© */
    .chat-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: var(--bg-light);
      border-radius: var(--border-radius);
      border: 1px solid rgba(0, 255, 136, 0.1);
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }
    
    #chat {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    
    /* ØªØ®ØµÙŠØµ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± */
    #chat::-webkit-scrollbar {
      width: 8px;
    }
    
    #chat::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.1);
      border-radius: 4px;
    }
    
    #chat::-webkit-scrollbar-thumb {
      background: var(--primary-color);
      border-radius: 4px;
    }
    
    .message {
      max-width: 85%;
      padding: 15px 20px;
      border-radius: var(--border-radius);
      position: relative;
      animation: fadeIn 0.3s ease;
      line-height: 1.5;
      word-wrap: break-word;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .user-message {
      align-self: flex-start;
      background: rgba(77, 171, 247, 0.15);
      border: 1px solid rgba(77, 171, 247, 0.3);
      color: var(--user-color);
      border-top-right-radius: 5px;
    }
    
    .bot-message {
      align-self: flex-end;
      background: rgba(0, 255, 136, 0.1);
      border: 1px solid rgba(0, 255, 136, 0.3);
      color: var(--primary-color);
      border-top-left-radius: 5px;
    }
    
    .message-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      font-size: 0.85rem;
    }
    
    .sender {
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .time {
      color: #aaa;
      font-size: 0.75rem;
    }
    
    .message-content {
      font-size: 1rem;
    }
    
    /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
    .input-container {
      display: flex;
      gap: 15px;
      padding: 20px;
      background: var(--bg-light);
      border-top: 1px solid rgba(0, 255, 136, 0.1);
    }
    
    #msg {
      flex: 1;
      padding: 15px 20px;
      background: var(--bg-input);
      border: 1px solid rgba(0, 255, 136, 0.2);
      border-radius: var(--border-radius);
      color: var(--text-color);
      font-size: 1rem;
      transition: var(--transition);
    }
    
    #msg:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 2px rgba(0, 255, 136, 0.2);
    }
    
    #msg::placeholder {
      color: #666;
    }
    
    .send-btn {
      padding: 0 30px;
      background: var(--primary-color);
      color: #000;
      border: none;
      border-radius: var(--border-radius);
      font-weight: bold;
      font-size: 1rem;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    
    .send-btn:hover {
      background: var(--primary-dark);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 255, 136, 0.3);
    }
    
    .send-btn:active {
      transform: translateY(0);
    }
    
    .send-btn:disabled {
      background: #555;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    /* Ø§Ù„Ø­Ø§Ù„Ø© */
    .status {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      padding: 10px;
      font-size: 0.9rem;
      color: #aaa;
    }
    
    .status-indicator {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #00ff88;
      animation: blink 1.5s infinite;
    }
    
    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    
    /* Ø§Ù„ØªØ¬Ø§ÙˆØ¨ Ù…Ø¹ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ© */
    @media (max-width: 768px) {
      .container {
        height: auto;
        min-height: 100vh;
      }
      
      h1 {
        font-size: 1.8rem;
      }
      
      .controls {
        flex-direction: column;
      }
      
      .input-container {
        flex-direction: column;
      }
      
      .send-btn {
        padding: 15px;
      }
      
      .message {
        max-width: 95%;
      }
    }
    
    /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© */
    .typing-indicator {
      display: flex;
      align-items: center;
      gap: 5px;
      padding: 15px 20px;
      background: rgba(0, 255, 136, 0.1);
      border-radius: var(--border-radius);
      align-self: flex-end;
      margin-bottom: 10px;
      border: 1px solid rgba(0, 255, 136, 0.3);
    }
    
    .typing-dot {
      width: 8px;
      height: 8px;
      background: var(--primary-color);
      border-radius: 50%;
      animation: typing 1.4s infinite;
    }
    
    .typing-dot:nth-child(2) {
      animation-delay: 0.2s;
    }
    
    .typing-dot:nth-child(3) {
      animation-delay: 0.4s;
    }
    
    @keyframes typing {
      0%, 60%, 100% { transform: translateY(0); }
      30% { transform: translateY(-10px); }
    }
  </style>
</head>
<body>
  <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ±Ø®ÙŠØµ -->
  <div class="license-modal" id="licenseModal">
    <div class="license-box">
      <h2>ğŸ”’ WormGPT Pro</h2>
      <p>Ù‡Ø°Ù‡ Ù†Ø³Ø®Ø© Pro ØªØªØ·Ù„Ø¨ ØªÙØ¹ÙŠÙ„Ø§Ù‹ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒØ§Ù…Ù„ Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª.</p>
      <p>Ø£Ø¯Ø®Ù„ Ù…ÙØªØ§Ø­ Ø§Ù„ØªØ±Ø®ÙŠØµ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ:</p>
      
      <input type="text" id="licenseKey" class="license-input" placeholder="Ø£Ø¯Ø®Ù„ Ù…ÙØªØ§Ø­ Ø§Ù„ØªØ±Ø®ÙŠØµ Ù‡Ù†Ø§" maxlength="25">
      
      <button class="license-btn" onclick="activateLicense()">ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ±Ø®ÙŠØµ</button>
      
      <div id="licenseStatus" class="license-status"></div>
      
      <div style="margin-top: 20px; color: #888; font-size: 0.9rem;">
        <p>ğŸ”‘ Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±:</p>
        <p style="font-family: monospace; color: var(--primary-color); margin: 10px 0;">
          WORMGPT-PRO-2024-XYZ123<br>
          PREMIUM-ACCESS-CODE-999<br>
          VIP-LICENSE-888-ALPHA
        </p>
      </div>
    </div>
  </div>

  <div class="container" id="mainContainer" style="display: none;">
    <header>
      <div class="logo">
        <div class="logo-icon">ğŸ</div>
        <h1>WormGPT Chat <span class="premium-badge">PRO â­</span></h1>
      </div>
      <p class="tagline">Ù†Ø³Ø®Ø© Pro - Ù…Ø­Ø§Ø¯Ø«Ø© Ø°ÙƒÙŠØ© Ù…Ø¹ Ø¯Ø¹Ù… Ø§Ù„Ø¨Ø­Ø« Ø¹Ù„Ù‰ Ø§Ù„ÙˆÙŠØ¨ ÙˆØ±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª</p>
    </header>
    
    <div class="controls">
      <div class="control-group">
        <label for="webSearch">
          <input type="checkbox" id="webSearch">
          ğŸ” ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù„Ù‰ Ø§Ù„ÙˆÙŠØ¨
        </label>
      </div>
      
      <div class="control-group">
        <label class="file-label" for="fileUpload">
          ğŸ“ Ø±ÙØ¹ Ù…Ù„Ù
          <input type="file" id="fileUpload" accept=".txt,.pdf,.doc,.docx,.json">
        </label>
        <div id="fileInfo" class="file-info"></div>
      </div>
    </div>
    
    <div class="chat-container">
      <div id="chat">
        <div class="message bot-message">
          <div class="message-header">
            <div class="sender">ğŸ WormGPT Pro</div>
            <div class="time" id="current-time"></div>
          </div>
          <div class="message-content">Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø£Ù†Ø§ WormGPT Pro. Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ù…ÙŠØ²Ø© Ù…ÙØ¹Ù‘Ù„Ø©! ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ ÙŠÙ…ÙƒÙ†Ùƒ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù„Ù‰ Ø§Ù„ÙˆÙŠØ¨ Ø£Ùˆ Ø±ÙØ¹ Ù…Ù„Ù Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¥Ø¬Ø§Ø¨Ø§Øª Ø£ÙƒØ«Ø± Ø¯Ù‚Ø©.</div>
        </div>
      </div>
      
      <div class="input-container">
        <input type="text" id="msg" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..." autocomplete="off" />
        <button class="send-btn" onclick="sendMessage()" id="sendBtn">
          <span>Ø¥Ø±Ø³Ø§Ù„</span>
          <span>â¤</span>
        </button>
      </div>
    </div>
    
    <div class="status">
      <div class="status-indicator"></div>
      <span id="connectionStatus">Ù…ØªØµÙ„ ÙˆØ¬Ø§Ù‡Ø² Ù„Ù„Ø±Ø¯ - Ø§Ù„Ù†Ø³Ø®Ø© Pro</span>
    </div>
  </div>

  <script>
    const API_URL = "https://aolckxwjfendnyrkrapc.supabase.co/functions/v1/wormgpt";
    const API_KEY = "worm_NtK9F9cl-oTWhoYY0-nH0r39Cg-2f4nytWs"; // Ø¶Ø¹ Ù…ÙØªØ§Ø­Ùƒ Ù‡Ù†Ø§
    
    // Ù…ÙØ§ØªÙŠØ­ Ø§Ù„ØªØ±Ø®ÙŠØµ Ø§Ù„ØµØ§Ù„Ø­Ø© (ÙŠÙ…ÙƒÙ†Ùƒ ØªÙˆØ³ÙŠØ¹ Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©)
    const VALID_LICENSE_KEYS = [
      "WORMGPT-PRO-2024-XYZ123",
      "PREMIUM-ACCESS-CODE-999",
      "VIP-LICENSE-888-ALPHA",
      "PRO-ACCESS-777-BETA",
      "WORMGPT-ULTIMATE-555"
    ];
    
    // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
    let fileContent = null;
    let currentFileName = "";
    let isLicenseActive = false;
    let licenseKey = "";
    
    // ÙØ­Øµ Ø§Ù„ØªØ±Ø®ÙŠØµ Ø§Ù„Ù…Ø­ÙÙˆØ¸ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    function checkSavedLicense() {
      const savedLicense = localStorage.getItem('wormgpt_license');
      if (savedLicense && VALID_LICENSE_KEYS.includes(savedLicense)) {
        activateApp(savedLicense);
      } else {
        showLicenseModal();
      }
    }
    
    // Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ±Ø®ÙŠØµ
    function showLicenseModal() {
      document.getElementById('licenseModal').style.display = 'flex';
      document.getElementById('mainContainer').style.display = 'none';
    }
    
    // Ø¥Ø®ÙØ§Ø¡ Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ±Ø®ÙŠØµ
    function hideLicenseModal() {
      document.getElementById('licenseModal').style.display = 'none';
      document.getElementById('mainContainer').style.display = 'flex';
    }
    
    // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ±Ø®ÙŠØµ
    function activateLicense() {
      const licenseInput = document.getElementById('licenseKey');
      const key = licenseInput.value.trim().toUpperCase();
      const statusDiv = document.getElementById('licenseStatus');
      
      if (!key) {
        statusDiv.className = 'license-status status-error';
        statusDiv.innerHTML = 'âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù…ÙØªØ§Ø­ Ø§Ù„ØªØ±Ø®ÙŠØµ';
        statusDiv.style.display = 'block';
        return;
      }
      
      if (VALID_LICENSE_KEYS.includes(key)) {
        // Ø­ÙØ¸ Ø§Ù„ØªØ±Ø®ÙŠØµ ÙÙŠ localStorage
        localStorage.setItem('wormgpt_license', key);
        licenseKey = key;
        isLicenseActive = true;
        
        // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
        statusDiv.className = 'license-status status-success';
        statusDiv.innerHTML = 'âœ… ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ±Ø®ÙŠØµ Ø¨Ù†Ø¬Ø§Ø­! Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚...';
        statusDiv.style.display = 'block';
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØ©
        setTimeout(() => {
          activateApp(key);
        }, 1500);
        
      } else {
        statusDiv.className = 'license-status status-error';
        statusDiv.innerHTML = 'âŒ Ù…ÙØªØ§Ø­ Ø§Ù„ØªØ±Ø®ÙŠØµ ØºÙŠØ± ØµØ§Ù„Ø­. Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.';
        statusDiv.style.display = 'block';
        
        // Ø§Ù‡ØªØ²Ø§Ø² Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
        licenseInput.style.animation = 'shake 0.5s';
        setTimeout(() => {
          licenseInput.style.animation = '';
        }, 500);
      }
    }
    
    // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ±Ø®ÙŠØµ
    function activateApp(key) {
      hideLicenseModal();
      isLicenseActive = true;
      licenseKey = key;
      
      // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„
      document.getElementById('connectionStatus').innerHTML = 
        `Ù…ØªØµÙ„ ÙˆØ¬Ø§Ù‡Ø² Ù„Ù„Ø±Ø¯ - Ø§Ù„Ù†Ø³Ø®Ø© Pro â­ | Ø§Ù„ØªØ±Ø®ÙŠØµ: ${key.substring(0, 8)}...`;
      
      // Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨ Pro
      const chat = document.getElementById('chat');
      chat.innerHTML = `
        <div class="message bot-message">
          <div class="message-header">
            <div class="sender">ğŸ WormGPT Pro â­</div>
            <div class="time" id="current-time"></div>
          </div>
          <div class="message-content">
            <strong>Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø§Ù„Ù†Ø³Ø®Ø© Pro Ù…ÙØ¹Ù‘Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰</strong><br><br>
            ğŸ”¹ Ø§Ù„ØªØ±Ø®ÙŠØµ: ${key}<br>
            ğŸ”¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ù…ØªØ§Ø­Ø© Ø§Ù„Ø¢Ù†<br>
            ğŸ”¹ Ø¯Ø¹Ù… Ø§Ù„Ø¨Ø­Ø« Ø¹Ù„Ù‰ Ø§Ù„ÙˆÙŠØ¨<br>
            ğŸ”¹ Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ù…ØªØ§Ø­<br>
            ğŸ”¹ Ø³Ø±Ø¹Ø© Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù…Ù…ØªØ§Ø²Ø©<br><br>
            ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ
          </div>
        </div>
      `;
      
      updateTime();
      
      // ØªÙ…ÙƒÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª
      document.getElementById('webSearch').disabled = false;
      document.getElementById('fileUpload').disabled = false;
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ
    function updateTime() {
      const now = new Date();
      const timeString = now.toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit' });
      document.getElementById('current-time').textContent = timeString;
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
    setInterval(updateTime, 60000);
    
    // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª
    document.getElementById('fileUpload').onchange = async (e) => {
      if (!isLicenseActive) {
        alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ±Ø®ÙŠØµ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø©.');
        return;
      }
      
      const file = e.target.files[0];
      if (!file) return;
      
      currentFileName = file.name;
      document.getElementById('fileInfo').textContent = `ØªÙ… Ø±ÙØ¹: ${file.name}`;
      
      // Ù‚Ø±Ø§Ø¡Ø© Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù„Ù
      const reader = new FileReader();
      reader.onload = function(event) {
        fileContent = event.target.result;
        addMessageToChat(`âœ… ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù "${file.name}" Ø¨Ù†Ø¬Ø§Ø­ (Ù…ÙŠØ²Ø© Pro).`, 'bot');
      };
      
      if (file.type.startsWith('text/') || file.name.endsWith('.txt') || file.name.endsWith('.json')) {
        reader.readAsText(file);
      } else {
        reader.readAsDataURL(file);
        addMessageToChat(`âœ… ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù "${file.name}". Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ ÙÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©.`, 'bot');
      }
    };
    
    // Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ø´Ø§Øª
    function addMessageToChat(message, sender) {
      const chat = document.getElementById('chat');
      const now = new Date();
      const timeString = now.toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit' });
      
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${sender === 'user' ? 'user-message' : 'bot-message'}`;
      
      const senderName = sender === 'user' ? 'Ø£Ù†Øª' : 'ğŸ WormGPT Pro';
      const senderIcon = sender === 'user' ? 'ğŸ‘¤' : 'ğŸ';
      
      messageDiv.innerHTML = `
        <div class="message-header">
          <div class="sender">${senderIcon} ${senderName} ${sender === 'bot' ? 'â­' : ''}</div>
          <div class="time">${timeString}</div>
        </div>
        <div class="message-content">${message}</div>
      `;
      
      chat.appendChild(messageDiv);
      chat.scrollTop = chat.scrollHeight;
    }
    
    // Ø¥Ø¶Ø§ÙØ© Ù…Ø¤Ø´Ø± Ø§Ù„ÙƒØªØ§Ø¨Ø©
    function showTypingIndicator() {
      const chat = document.getElementById('chat');
      const typingDiv = document.createElement('div');
      typingDiv.className = 'typing-indicator';
      typingDiv.id = 'typingIndicator';
      typingDiv.innerHTML = `
        <div class="typing-dot"></div>
        <div class="typing-dot"></div>
        <div class="typing-dot"></div>
      `;
      chat.appendChild(typingDiv);
      chat.scrollTop = chat.scrollHeight;
    }
    
    // Ø¥Ø®ÙØ§Ø¡ Ù…Ø¤Ø´Ø± Ø§Ù„ÙƒØªØ§Ø¨Ø©
    function hideTypingIndicator() {
      const typingIndicator = document.getElementById('typingIndicator');
      if (typingIndicator) {
        typingIndicator.remove();
      }
    }
    
    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
    async function sendMessage() {
      if (!isLicenseActive) {
        alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ±Ø®ÙŠØµ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Chat.');
        showLicenseModal();
        return;
      }
      
      const msgInput = document.getElementById('msg');
      const msg = msgInput.value.trim();
      const sendBtn = document.getElementById('sendBtn');
      
      if (!msg) return;
      
      // Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
      addMessageToChat(msg, 'user');
      
      // ØªÙØ±ÙŠØº Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙˆØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø²Ø±
      msgInput.value = '';
      sendBtn.disabled = true;
      sendBtn.innerHTML = '<span>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...</span>';
      
      // Ø¹Ø±Ø¶ Ù…Ø¤Ø´Ø± Ø§Ù„ÙƒØªØ§Ø¨Ø©
      showTypingIndicator();
      
      // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¥Ø±Ø³Ø§Ù„
      const webEnabled = document.getElementById('webSearch').checked;
      const body = { 
        api_key: API_KEY, 
        message: msg, 
        web_enabled: webEnabled,
        license_key: licenseKey, // Ø¥Ø¶Ø§ÙØ© Ù…ÙØªØ§Ø­ Ø§Ù„ØªØ±Ø®ÙŠØµ
        pro_version: true
      };
      
      if (fileContent) {
        body.file_content = fileContent;
        body.file_name = currentFileName;
      }
      
      try {
        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ù„Ù„Ø®Ø§Ø¯Ù…
        const res = await fetch(API_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(body)
        });
        
        const data = await res.json();
        
        // Ø¥Ø®ÙØ§Ø¡ Ù…Ø¤Ø´Ø± Ø§Ù„ÙƒØªØ§Ø¨Ø©
        hideTypingIndicator();
        
        // Ø¥Ø¶Ø§ÙØ© Ø±Ø¯ WormGPT
        const responseText = data.response || data.error || 'Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù„Ù… Ø£ØªÙ…ÙƒÙ† Ù…Ù† Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨Ùƒ.';
        addMessageToChat(responseText, 'bot');
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù„Ù Ø¨Ø¹Ø¯ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡
        if (fileContent) {
          fileContent = null;
          currentFileName = "";
          document.getElementById('fileInfo').textContent = "";
        }
        
      } catch (error) {
        // Ø¥Ø®ÙØ§Ø¡ Ù…Ø¤Ø´Ø± Ø§Ù„ÙƒØªØ§Ø¨Ø©
        hideTypingIndicator();
        
        // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£
        addMessageToChat('Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.', 'bot');
        console.error('Error:', error);
      } finally {
        // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ…ÙƒÙŠÙ† Ø§Ù„Ø²Ø±
        sendBtn.disabled = false;
        sendBtn.innerHTML = '<span>Ø¥Ø±Ø³Ø§Ù„</span><span>â¤</span>';
        msgInput.focus();
      }
    }
    
    // Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter
    document.getElementById('msg').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        sendMessage();
      }
    });
    
    // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø§Ù‡ØªØ²Ø§Ø² Ù„Ù„Ù†Ø§ÙØ°Ø©
    const style = document.createElement('style');
    style.innerHTML = `
      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
        20%, 40%, 60%, 80% { transform: translateX(5px); }
      }
    `;
    document.head.appendChild(style);
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªØ±Ø®ÙŠØµ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    window.onload = function() {
      checkSavedLicense();
      document.getElementById('msg').focus();
    };
    
    // Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„ ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØªØ±Ø®ÙŠØµ
    function addReloadButton() {
      const statusDiv = document.querySelector('.status');
      const reloadBtn = document.createElement('button');
      reloadBtn.innerHTML = 'ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„';
      reloadBtn.style.background = 'var(--premium-color)';
      reloadBtn.style.color = '#000';
      reloadBtn.style.border = 'none';
      reloadBtn.style.padding = '5px 10px';
      reloadBtn.style.borderRadius = '5px';
      reloadBtn.style.cursor = 'pointer';
      reloadBtn.style.marginLeft = '10px';
      reloadBtn.onclick = function() {
        localStorage.removeItem('wormgpt_license');
        location.reload();
      };
      statusDiv.appendChild(reloadBtn);
    }
  </script>
</body>
    </html>
